# 集群运维

## 集群简介

## 账户申请

1. 填写申请表（需导师签字）
2. 进群，看公告，及时在gridview上注册账户(http://58.206.100.48:6080/ 需在校网登陆)
3. 管理员登陆gridview系统通过申请
4. 在gridview系统中进入“用户资源设置”界面，更改新用户的最大处理器数为96.
5. ssh登陆48号机，切换到新用户下（su - <新用户>，脚本会运行为其产生密钥）
6. 下载密钥并发送给同学即可

## 关机

1. 登录管理节点：

   1. 48 **root:mlyd@mvyli**
   2. 49 **root:inspur**

2. 杀死所有任务

   1. 48  

      查询任务命令 `pestat` or `showq`

      杀死任务命令`qdel -a`  or `qdel all`

   2. 49  

      查询状态命令 `sinfo`

      查询任务命令 `sacct` or  `squeue`

      杀死任务命令`scancel + <job id >`

3. 关掉计算节点
   1.  48 运行 **root** 家目录下的 **close.sh** 脚本
   2.  49 不知为何运行 `ssh cu01 shutdown -P now`

    时一直会提示输入密码，还未尝试通过脚本来进行关闭

4. 关闭管理节点

   运行 `shutdown -P now` 即可

## 启动

### 48

先开管理节点（位于显示器的上一个），键盘上4号是管理节点，1 2 3是线，6是胖节点，

### 49

先开管理节点（位于显示器的下一个），mu01

测试是否成功启动的方法：

远程命令，在48上输入以下命令：

```
ssh -i root@58.206.100.49:22
```

（貌似该命令有问题，等待修复）

## tips 

### 常见命令

`qstartx` 开启图形界面

`pestat` PBS查询任务命令

`showq` 曙光服务器查询任务命令

`qdel` PBS的杀死任务命令 `-a` 表示杀死所有任务

`sinfo`  Slurm的查询节点分区状态命令

`sacct` Slurm的查询任务状态命令

`squeue` Slurm的查询队列状态命令

`scancel` Slurm的删除任务命令

`shutdown`  `-p` 本地关闭计算机 `-h` 本地休眠计算机

`(49上）Fn + Home` 调出菜单栏

### 开关箱

带有标签的分别代表1、2、3、4号机柜

不带标签的是空调专线

### 维修人员联系方式

年师傅 联系方式待补充（from 王亦清）

### 机房负责人

黄振雄 

刘东宇

司亦涛（协助）

汪龙

王亦清 





